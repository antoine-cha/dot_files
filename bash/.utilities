#!/bin/bash

function cmd_exists() {
    if command -v $1 > /dev/null 2>&1; then
        return 0
    else
        return 1
    fi
}

function toggle-python() {
    PYTHON_VERSION=$1
    if [ "$PYTHON_VERSION" == "$_CUR_PYTHON_VERSION" ]; then
        echo "Using python $PYTHON_VERSION"
        return 0
    fi
    if [ "$#" -ne 1 ]; then
        echo "Error: missing PYTHON_VERSION parameter"
        return 1
    fi
    if ! cmd_exists python$PYTHON_VERSION; then
        echo "Error: python$PYTHON_VERSION is not installed"
        return 1
    fi
    echo "*** Toggling Python$PYTHON_VERSION *** "
    NEW_PYTHON="python$PYTHON_VERSION"
    NEW_PIP="python$PYTHON_VERSION -m pip"
    NEW_PYLINT="python$PYTHON_VERSION -m pylint"
    SUDO_PIP="sudo $NEW_PIP"
    $NEW_PYTHON --version
    $NEW_PIP --version
    $NEW_PIP install --quiet --upgrade pip
    echo "*** Pylint"
    $NEW_PIP install --quiet pylint
    $NEW_PYLINT --version
    # Aliases defined in a function are not available until after that function is executed
    alias python=$NEW_PYTHON
    alias pip=$NEW_PIP
    alias supip=$SUDO_PIP
    alias pylint=$NEW_PYLINT
    export _CUR_PYTHON_VERSION=$PYTHON_VERSION
}
